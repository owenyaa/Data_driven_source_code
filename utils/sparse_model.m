function dydt = sparse_model(t, y, RXi)
    num_RXi = numel(RXi);
    
    if num_RXi == 27
        dydt = [
            RXi(1)*y(1) + RXi(2)*y(2) + RXi(3)*y(3) + RXi(4)*y(1)^2 + ...
            RXi(5)*y(1)*y(2) + RXi(6)*y(1)*y(3) + RXi(7)*y(2)^2 + ...
            RXi(8)*y(2)*y(3) + RXi(9)*y(3)^2; ...                              %eq1
            RXi(10)*y(1) + RXi(11)*y(2) + RXi(12)*y(3) + RXi(13)*y(1)^2 + ...
            RXi(14)*y(1)*y(2) + RXi(15)*y(1)*y(3) + RXi(16)*y(2)^2 + ...
            RXi(17)*y(2)*y(3) + RXi(18)*y(3)^2; ...                            %eq2
            RXi(19)*y(1) + RXi(20)*y(2) + RXi(21)*y(3) + RXi(22)*y(1)^2 + ...
            RXi(23)*y(1)*y(2) + RXi(24)*y(1)*y(3) + RXi(25)*y(2)^2 + ...
            RXi(26)*y(2)*y(3) + RXi(27)*y(3)^2                                 %eq3
        ];
    elseif num_RXi == 57
        dydt = [
            RXi(1)*y(1) + RXi(2)*y(2) + RXi(3)*y(3) + RXi(4)*y(1)^2 + ...
            RXi(5)*y(1)*y(2) + RXi(6)*y(1)*y(3) + RXi(7)*y(2)^2 + ...
            RXi(8)*y(2)*y(3) + RXi(9)*y(3)^2 + RXi(10)*y(1)^3 + ... 
            RXi(11)*y(1)^2*y(2) + RXi(12)*y(1)^2*y(3) + RXi(13)*y(1)*y(2)^2 + ...
            RXi(14)*y(1)*y(2)*y(3) + RXi(15)*y(1)*y(3)^2 + RXi(16)*y(2)^3 + ...
            RXi(17)*y(2)^2*y(3) + RXi(18)*y(2)*y(3)^2 + RXi(19)*y(3)^3; ...          %eq1
            RXi(20)*y(1) + RXi(21)*y(2) + RXi(22)*y(3) + RXi(23)*y(1)^2 + ...
            RXi(24)*y(1)*y(2) + RXi(25)*y(1)*y(3) + RXi(26)*y(2)^2 + ...
            RXi(27)*y(2)*y(3) + RXi(28)*y(3)^2 + RXi(29)*y(1)^3 + ... 
            RXi(30)*y(1)^2*y(2) + RXi(31)*y(1)^2*y(3) + RXi(32)*y(1)*y(2)^2 + ...
            RXi(33)*y(1)*y(2)*y(3) + RXi(34)*y(1)*y(3)^2 + RXi(35)*y(2)^3 + ...
            RXi(36)*y(2)^2*y(3) + RXi(37)*y(2)*y(3)^2 + RXi(38)*y(3)^3; ...          %eq2
            RXi(39)*y(1) + RXi(40)*y(2) + RXi(41)*y(3) + RXi(42)*y(1)^2 + ...
            RXi(43)*y(1)*y(2) + RXi(44)*y(1)*y(3) + RXi(45)*y(2)^2 + ...
            RXi(46)*y(2)*y(3) + RXi(47)*y(3)^2 + RXi(48)*y(1)^3 + ... 
            RXi(49)*y(1)^2*y(2) + RXi(50)*y(1)^2*y(3) + RXi(51)*y(1)*y(2)^2 + ...
            RXi(52)*y(1)*y(2)*y(3) + RXi(53)*y(1)*y(3)^2 + RXi(54)*y(2)^3 + ...
            RXi(55)*y(2)^2*y(3) + RXi(56)*y(2)*y(3)^2 + RXi(57)*y(3)^3               %eq3
        ];
    elseif num_RXi == 45                                                   %Chua
        dydt = [
            RXi(1)*abs(y(1)+1)+RXi(2)*abs(y(2)+1)+RXi(3)*abs(y(3)+1)+ ...
            RXi(4)*abs(y(1)-1)+RXi(5)*abs(y(2)-1)+RXi(6)*abs(y(3)-1)+ ...
            RXi(7)*y(1) + RXi(8)*y(2) + RXi(9)*y(3) + RXi(10)*y(1)^2 + ...
            RXi(11)*y(1)*y(2) + RXi(12)*y(1)*y(3) + RXi(13)*y(2)^2 + ...
            RXi(14)*y(2)*y(3) + RXi(15)*y(3)^2; ...                        %eq1
            RXi(16)*abs(y(1)+1)+RXi(17)*abs(y(2)+1)+RXi(18)*abs(y(3)+1)+ ...
            RXi(19)*abs(y(1)-1)+RXi(20)*abs(y(2)-1)+RXi(21)*abs(y(3)-1)+ ...
            RXi(22)*y(1) + RXi(23)*y(2) + RXi(24)*y(3) + RXi(25)*y(1)^2 + ...
            RXi(26)*y(1)*y(2) + RXi(27)*y(1)*y(3) + RXi(28)*y(2)^2 + ...
            RXi(29)*y(2)*y(3) + RXi(30)*y(3)^2; ...                        %eq2
            RXi(31)*abs(y(1)+1)+RXi(32)*abs(y(2)+1)+RXi(33)*abs(y(3)+1)+ ...
            RXi(34)*abs(y(1)-1)+RXi(35)*abs(y(2)-1)+RXi(36)*abs(y(3)-1)+ ...
            RXi(37)*y(1) + RXi(38)*y(2) + RXi(39)*y(3) + RXi(40)*y(1)^2 + ...
            RXi(41)*y(1)*y(2) + RXi(42)*y(1)*y(3) + RXi(43)*y(2)^2 + ...
            RXi(44)*y(2)*y(3) + RXi(45)*y(3)^2                             %eq3
        ];
    elseif num_RXi == 33                                                   %Chua
        dydt = [
            RXi(1)*abs(y(1)+1)+RXi(2)*abs(y(1)-1)+ ...
            RXi(3)*y(1) + RXi(4)*y(2) + RXi(5)*y(3) + RXi(6)*y(1)^2 + ...
            RXi(7)*y(1)*y(2) + RXi(8)*y(1)*y(3) + RXi(9)*y(2)^2 + ...
            RXi(10)*y(2)*y(3) + RXi(11)*y(3)^2; ... 
            RXi(12)*abs(y(1)+1)+RXi(13)*abs(y(1)-1)+ ...
            RXi(14)*y(1) + RXi(15)*y(2) + RXi(16)*y(3) + RXi(17)*y(1)^2 + ...
            RXi(18)*y(1)*y(2) + RXi(19)*y(1)*y(3) + RXi(20)*y(2)^2 + ...
            RXi(21)*y(2)*y(3) + RXi(22)*y(3)^2; ... 
            RXi(23)*abs(y(1)+1)+RXi(24)*abs(y(1)-1)+ ...
            RXi(25)*y(1) + RXi(26)*y(2) + RXi(27)*y(3) + RXi(28)*y(1)^2 + ...
            RXi(29)*y(1)*y(2) + RXi(30)*y(1)*y(3) + RXi(31)*y(2)^2 + ...
            RXi(32)*y(2)*y(3) + RXi(33)*y(3)^2 
        ];    
    else
        error('Invalid number of RXi coefficients. Expected 27 or 57.');
    end
end

